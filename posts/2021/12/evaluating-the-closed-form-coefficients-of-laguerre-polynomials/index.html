<!DOCTYPE html>
<html lang="en-us">

<head>
  <meta http-equiv="X-Clacks-Overhead" content="GNU Terry Pratchett" />
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Evaluating the closed form coefficients of Laguerre polynomials | Ivan Pribec</title>
<meta name="title" content="Evaluating the closed form coefficients of Laguerre polynomials" />
<meta name="description" content="Evaluating the closed form coefficients of Laguerre polynomials
For some numerical applications it can be useful to work with the closed form
expression for Laguerre polynomials. The closed form is given by



$$L_n(x) = \sum_{k=0}^n {n \choose k} \frac{(-1)^k}{k!} x^k$$
(1)


We can evaluate the coefficients with the help of the factorial formula



$$\binom{n}{k} = \frac{n!}{k!\,(n-k)!}$$
(2)


Since $n$ and $k$ are both integers, the coefficients are rational numbers.
For most computational applications we will likely only need to work with
floating point approximations of the coefficients." />
<meta name="keywords" content="Laguerre,Polynomials,Fortran," />


<meta property="og:url" content="/posts/2021/12/evaluating-the-closed-form-coefficients-of-laguerre-polynomials/">
  <meta property="og:site_name" content="Ivan Pribec">
  <meta property="og:title" content="Evaluating the closed form coefficients of Laguerre polynomials">
  <meta property="og:description" content="Evaluating the closed form coefficients of Laguerre polynomials For some numerical applications it can be useful to work with the closed form expression for Laguerre polynomials. The closed form is given by
$$L_n(x) = \sum_{k=0}^n {n \choose k} \frac{(-1)^k}{k!} x^k$$ (1) We can evaluate the coefficients with the help of the factorial formula
$$\binom{n}{k} = \frac{n!}{k!\,(n-k)!}$$ (2) Since $n$ and $k$ are both integers, the coefficients are rational numbers. For most computational applications we will likely only need to work with floating point approximations of the coefficients.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2021-12-29T00:00:00+00:00">
    <meta property="article:modified_time" content="2021-12-29T00:00:00+00:00">
    <meta property="article:tag" content="Laguerre">
    <meta property="article:tag" content="Polynomials">
    <meta property="article:tag" content="Fortran">




  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Evaluating the closed form coefficients of Laguerre polynomials">
  <meta name="twitter:description" content="Evaluating the closed form coefficients of Laguerre polynomials For some numerical applications it can be useful to work with the closed form expression for Laguerre polynomials. The closed form is given by
$$L_n(x) = \sum_{k=0}^n {n \choose k} \frac{(-1)^k}{k!} x^k$$ (1) We can evaluate the coefficients with the help of the factorial formula
$$\binom{n}{k} = \frac{n!}{k!\,(n-k)!}$$ (2) Since $n$ and $k$ are both integers, the coefficients are rational numbers. For most computational applications we will likely only need to work with floating point approximations of the coefficients.">




  <meta itemprop="name" content="Evaluating the closed form coefficients of Laguerre polynomials">
  <meta itemprop="description" content="Evaluating the closed form coefficients of Laguerre polynomials For some numerical applications it can be useful to work with the closed form expression for Laguerre polynomials. The closed form is given by
$$L_n(x) = \sum_{k=0}^n {n \choose k} \frac{(-1)^k}{k!} x^k$$ (1) We can evaluate the coefficients with the help of the factorial formula
$$\binom{n}{k} = \frac{n!}{k!\,(n-k)!}$$ (2) Since $n$ and $k$ are both integers, the coefficients are rational numbers. For most computational applications we will likely only need to work with floating point approximations of the coefficients.">
  <meta itemprop="datePublished" content="2021-12-29T00:00:00+00:00">
  <meta itemprop="dateModified" content="2021-12-29T00:00:00+00:00">
  <meta itemprop="wordCount" content="336">
  <meta itemprop="keywords" content="Laguerre,Polynomials,Fortran">
<meta name="referrer" content="no-referrer-when-downgrade" />

  <style>
  :root {
    --width: 720px;
    --font-main: Verdana, sans-serif;
    --font-secondary: Verdana, sans-serif;
    --font-scale: 1em;
    --background-color: #fff;
    --heading-color: #222;
    --text-color: #444;
    --link-color: #3273dc;
    --visited-color: #8b6fcb;
    --blockquote-color: #222;
  }

  @media (prefers-color-scheme: dark) {
    :root {
      --background-color: #01242e;
      --heading-color: #eee;
      --text-color: #ddd;
      --link-color: #8cc2dd;
      --visited-color: #8b6fcb;
      --blockquote-color: #ccc;
    }
  }

  body {
    font-family: var(--font-secondary);
    font-size: var(--font-scale);
    margin: auto;
    padding: 20px;
    max-width: var(--width);
    text-align: left;
    background-color: var(--background-color);
    word-wrap: break-word;
    overflow-wrap: break-word;
    line-height: 1.5;
    color: var(--text-color);
  }

  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    font-family: var(--font-main);
    color: var(--heading-color);
  }

  a {
    color: var(--link-color);
    cursor: pointer;
    text-decoration: none;
  }

  a:hover {
    text-decoration: underline;
  }

  nav a {
    margin-right: 8px;
  }

  strong,
  b {
    color: var(--heading-color);
  }

  button {
    margin: 0;
    cursor: pointer;
  }

  time {
    font-family: monospace;
    font-style: normal;
    font-size: 15px;
  }

  main {
    line-height: 1.6;
  }

  table {
    width: 100%;
  }

  hr {
    border: 0;
    border-top: 1px dashed;
  }

  img {
    max-width: 100%;
  }

  code {
    font-family: monospace;
    padding: 2px;
    border-radius: 3px;
  }

  blockquote {
    border-left: 1px solid #999;
    color: var(--blockquote-color);
    padding-left: 20px;
    font-style: italic;
  }

  footer {
    padding: 25px 0;
    text-align: center;
  }

  .title:hover {
    text-decoration: none;
  }

  .title h1 {
    font-size: 1.5em;
  }

  .inline {
    width: auto !important;
  }

  .highlight,
  .code {
    border-radius: 3px;
    margin-block-start: 1em;
    margin-block-end: 1em;
    overflow-x: auto;
  }

   
  ul.blog-posts {
    list-style-type: none;
    padding: unset;
  }

  ul.blog-posts li {
    display: flex;
  }

  ul.blog-posts li span {
    flex: 0 0 130px;
  }

  ul.blog-posts li a:visited {
    color: var(--visited-color);
  }

</style>

</head>

<body>
  <header><a href="/" class="title">
  <h2>Ivan Pribec</h2>
</a>
<nav>
<a href="/posts/">blog</a>

<a href="/code/">code</a>

<a href="/diary/">diary</a>

<a href="/now/">now</a>

</nav>
</header>
  <main>

<content>
  <h1 id="evaluating-the-closed-form-coefficients-of-laguerre-polynomials">Evaluating the closed form coefficients of Laguerre polynomials</h1>
<p>For some numerical applications it can be useful to work with the closed form
expression for Laguerre polynomials. The closed form is given by</p>

<table style="width: 100%">
<td style="width: 10000px;"></td>
<td>$$L_n(x) = \sum_{k=0}^n {n \choose k} \frac{(-1)^k}{k!} x^k$$</td>
<td style="width: 10000px; text-align: right;">(1)</td>
</table>

<p>We can evaluate the coefficients with the help of the factorial formula</p>

<table style="width: 100%">
<td style="width: 10000px;"></td>
<td>$$\binom{n}{k} = \frac{n!}{k!\,(n-k)!}$$</td>
<td style="width: 10000px; text-align: right;">(2)</td>
</table>

<p>Since $n$ and $k$ are both integers, the coefficients are rational numbers.
For most computational applications we will likely only need to work with
floating point approximations of the coefficients.</p>
<p>When evaluating the coefficients using the factorial formula we should
be careful to avoid overflow. For example if we try to compute $$n!$$ using default Fortran integers (32-bit), it will only be possible to calculate coefficients for $n \leq 12$.</p>
<p>To avoid such issues we can calculate the coefficients using the
the gamma function $\Gamma$ and the logarithm thereof. This follows from the helpful observation that for integer arguments</p>

<table style="width: 100%">
<td style="width: 10000px;"></td>
<td>$$\Gamma(n&#43;1) = n!$$</td>
<td style="width: 10000px; text-align: right;">(3)</td>
</table>

<p>For the coefficients of $L_n(x)$, a straightforward Fortran implementation might look as follows:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fortran" data-lang="fortran"><span style="display:flex;"><span>  <span style="color:#66d9ef">pure</span> <span style="color:#66d9ef">function</span> lagcoefs(n) <span style="color:#66d9ef">result</span>(a)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">integer</span>, <span style="color:#66d9ef">intent</span>(in) <span style="color:#66d9ef">::</span> n
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">real</span> <span style="color:#66d9ef">::</span> a(<span style="color:#ae81ff">0</span>:n)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">integer</span> <span style="color:#66d9ef">::</span> k
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">do</span> k <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, n
</span></span><span style="display:flex;"><span>      a(k) <span style="color:#f92672">=</span> (<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">**</span>k <span style="color:#f92672">*</span> exp( &amp;
</span></span><span style="display:flex;"><span>            log_gamma(<span style="color:#66d9ef">real</span>(n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)) &amp;
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">-</span> <span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>log_gamma(<span style="color:#66d9ef">real</span>(k<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)) &amp;
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">-</span> log_gamma(<span style="color:#66d9ef">real</span>(n<span style="color:#f92672">-</span>k<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">end</span> <span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">end</span> <span style="color:#66d9ef">function</span>
</span></span></code></pre></div><p>where we have used the properties of logarithms to transform the quotient into
subtraction.  The input <code>n</code> should be a non-negative integer value.
The coefficients returned by the procedure are given in <em>ascending</em> order of
powers of $x$.</p>
<p>A similar procedure can be written for the derivative of the Laguerre polynomial.
These are given be the expression</p>

<table style="width: 100%">
<td style="width: 10000px;"></td>
<td>$$L&#39;_n(x) = \sum_{k=0}^n \binom{n}{k}\frac{(-1)^k}{k!} k x^{k-1}$$</td>
<td style="width: 10000px; text-align: right;">(4)</td>
</table>

<p>Here we should emphasize that the $i$-th derivative of a Laguerre polynomial
is polynomial of order ${n - i}$ (a polynomial of order $n$
is described by $n+1$ coefficients).</p>
<p>The implementation can also be adapted easily to return the coefficients of
the generalized Laguerre polynomials with the following closed form expression</p>

<table style="width: 100%">
<td style="width: 10000px;"></td>
<td>$$L_n^{(\alpha)}(x) = \sum_{k=0}^n (-1)^k \binom{n &#43; \alpha}{ n - k} \frac{x^k}{k!}$$</td>
<td style="width: 10000px; text-align: right;">(5)</td>
</table>


</content>



<p>
  
  <a href="/tags/laguerre/">#Laguerre</a>
  
  <a href="/tags/polynomials/">#Polynomials</a>
  
  <a href="/tags/fortran/">#Fortran</a>
  
</p>

  </main>
  <footer>Made with <a href="https://github.com/janraasch/hugo-bearblog/">Hugo ʕ•ᴥ•ʔ Bear</a>
</footer>

  
</body>

</html>
